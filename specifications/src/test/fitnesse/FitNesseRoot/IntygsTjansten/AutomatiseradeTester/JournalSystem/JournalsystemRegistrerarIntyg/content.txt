!3 Givet att samtycke finns för ${person1.personnummer} så ska det inte finnas några intyg invånaren än

|Samtycke|
|personnr|samtycke|
|${person1.personnummer}|ja|

|Hamta intyg|
|personnummer|intyg|resultat?|
|${person1.personnummer}|fit-intyg-1|[ERROR] - Certificate 'fit-intyg-1' does not exist for user '${person1.pnrhash}'|

!3 Efter journalsystemet har registrerat ett nytt intyg så ska det vara tillgängligt

|Registrera fk7263 intyg|
|personnummer|id|utfärdat|enhetsId|vårdGivarId|resultat?|
|${person1.personnummer}|fit-intyg-1|2013-08-01|enEnhet|enVårdGivare|OK|

|Hamta intyg|
|personnummer|intyg|resultat?|status?|
|${person1.personnummer}|fit-intyg-1|OK|[RECEIVED]|

!3 Kontrollera att intyget har korrekt vårdenhet och vårdgivare satt, och inte är flaggat som wire-tappat

|Kontrollera intyg|
|intyg|vårdEnhet?|vårdGivare?|wiretappat?|
|fit-intyg-1|enEnhet|enVårdGivare|false|

!3 Försök att registrera ett redan registrerat intyg ger INFO: intyget finns redan

|Registrera fk7263 intyg|
|personnummer|id|utfärdat|resultat?|
|${person1.personnummer}|fit-intyg-1|2013-08-01|[INFO] - Certificate already exists|

!3 Försök att registrera ett intyg med ett befintligt intygs-id på en annan invånare ger APPLICATION-ERROR
|Registrera fk7263 intyg|
|personnummer|id|utfärdat|resultat?|
|19121212-1212|fit-intyg-1|2013-08-01|[APPLICATION_ERROR] - Invalid certificate ID|

!3 Ta bort samtycke

|Samtycke|
|personnr|samtycke|
|${person1.personnummer}|nej|

!3 Rensa bort test-intyg

|ta bort Intyg|
|id|
|fit-intyg-1|

|script|!-TaBortSjukfallIntyg-!|
|ta bort alla sjukfall intyg|